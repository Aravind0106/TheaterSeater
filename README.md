# TheaterSeater

HOW TO RUN
---------------------------------
1. Download the projects to your local machine
2. Go to the source folder
3. hit "mvn clean install"

RESTAPI CALLS:
---------------------------------

1. GET
---------------
getNumOfSeatsAvail(int levelNum)
URI--> http://localhost:8080/TheaterSeaterWeb/rest/ticketService/numOfSeatsAvailOnLevel/{levelNum}
This will give the respone as : {"numOfAvailSeats":1250}

2. POST
---------------
URI--> http://localhost:8080/TheaterSeaterWeb/rest/ticketService/holdSeats
SeatHoldRequest:  {"minLevel":1,"maxLevel":2,"numSeats":2,"customerEmail":"aravind0106gmail.com"}
SeatHoldResponse: {"seatHoldCode":"a443faea-702b-4853-a6d2-b804459508d8","seatsHeld":[{"levelNumber":1,"seatNumber":1,"rowNumber":"1"},{"levelNumber":1,"seatNumber":2,"rowNumber":"1"}]}

-->SeatHoldCode is provided in the SeatHoldResponse, that can be used for Reserve seats call

3. POST
---------------
URI-->  http://localhost:8080/TheaterSeaterWeb/rest/ticketService/reserveSeat
ReserveSeatsInput:  {"seatHoldCode":"a443faea-702b-4853-a6d2-b804459508d8","customerEmail":"aravind0106gmail"}
ReserveSeatsOutput: {"confirmationCode":"aravind0106gmaila443faea-702b-4853-a6d2-b804459508d8"}

-->ConfirmationCODE  is string generated by sytem. This CODE is attached to every seat for the reference.

ABOUT THE APPLICATION
---------------------------------

This is a Maven multi module project that has below modules
1. Parent-->TheaterSeater
2. Children-->TheaterSeaterCommonObjects, TheaterSeaterData, TheaterSeaterService, TheaterSeaterRest, 		    
           TheaterSeaterWeb,TheaterSeaterInterfaces

BELOW IS THE TECHNOLOGY STACK:
---------------------------------
1. Spring 3.0.5(Annotation based) is Used for Dependency Injection
2. Mockito and Spring test frameworks are used for testing JUNIT 
3. Concurrency is accomplished by using Sychronization blocks at Row level
4. JERSEY is used for creating Rest based API
5. jaxb-api is used to convert xml to java objects
6. JSON Media type  used to interact with REST API
7. Log4j logging used
8. ExceptionMapper is used to send error code and description

APPLICATION TEST CASES COVERED
---------------------------------

int numSeatsAvailable(int venueLevel)
---------------------------------------------------------------------------------------------------------------
1.  Find number of seats at any particular level
2.  Check if the level is invalid
3.  Handles DataBase issue, if the config TheaterSeatsConfiguration.xml is not able to be parsed/not available.

SeatHold findAndHoldSeats(int numSeats, int minLevel, int maxLevel,String customerEmail)
---------------------------------------------------------------------------------------------------------------
1. Check if seats are available at particular level, and then go ahead to hold tickets
2. Check if the min and max level are provided with invalid levels
3. Check if the reservation is full in the provided levels
4. Concurrency when many threads access the same method at the same time

String reserveSeats(String seatHoldId, String customerEmail)
---------------------------------------------------------------------------------------------------------------
1. Check if the seat  is already reserved
2. Check if the hold code provided does not exist
3. Concurrency when many threads access the same method at the same time

-->When two theads look at same data on findAndHoldSeats and reserveSeats methods

All the above scenarios are covered in the Junit test cases


CONFIG FILES TO LOOK OUT FOR
----------------------------
1. The configuration file(TheaterSeatsConfiguration.xml) for loading the database is provided in TheaterSeaterData project
2. log4j.properties for logging config
3. Theater-Seater*.xml for spring dependency injections 
4. Pom.xmls in the parent and child projects
5. web.xml for rest mapping

